{"version":3,"file":"fetchCsvStream.js","names":["_papaparse","_interopRequireDefault","require","fetchCsvStream","_ref","uri","option","onFetch","onCheckResponse","onCompleted","onCatch","onFailed","_crErr","_crErrResp","_nowTime","_doneOk","_doneFailure","fetch","then","response","body","_reader","getReader","read","result","_str","String","fromCharCode","value","csv","parse","header","json","catch","error","_default","exports","default"],"sources":["../../src/network/fetchCsvStream.js"],"sourcesContent":["import csv from 'papaparse';\r\n\r\n\r\nconst fetchCsvStream = ({\r\n  uri,\r\n  option, onFetch, onCheckResponse, onCompleted,\r\n  onCatch, onFailed,\r\n  _crErr, _crErrResp,\r\n  _nowTime, _doneOk, _doneFailure\r\n}) => fetch(uri)\r\n    .then(response => {\r\n      if (response.body) {\r\n        const _reader = response.body.getReader();\r\n        return _reader.read();\r\n      } else {\r\n         throw _crErr(response);\r\n      }\r\n    })\r\n    .then(result => {\r\n      const _str = String.fromCharCode(...result.value);\r\n      return csv.parse(_str, { header: true });\r\n    })\r\n    .then(json => {\r\n      if (onCheckResponse(json)) {\r\n        onFetch({ json, option, onCompleted });\r\n        _doneOk(_nowTime)\r\n      } else {\r\n        throw _crErrResp();\r\n      }\r\n    })\r\n    .catch(error => {\r\n      onCatch({ error, option, onFailed })\r\n     _doneFailure(_nowTime)\r\n   });\r\n\r\nexport default fetchCsvStream\r\n"],"mappings":";;;;;AAAA,IAAAA,UAAA,GAAAC,sBAAA,CAAAC,OAAA;AAGA,MAAMC,cAAc,GAAGC,IAAA;EAAA,IAAC;IACtBC,GAAG;IACHC,MAAM;IAAEC,OAAO;IAAEC,eAAe;IAAEC,WAAW;IAC7CC,OAAO;IAAEC,QAAQ;IACjBC,MAAM;IAAEC,UAAU;IAClBC,QAAQ;IAAEC,OAAO;IAAEC;EACrB,CAAC,GAAAZ,IAAA;EAAA,OAAKa,KAAK,CAACZ,GAAG,CAAC,CACXa,IAAI,CAACC,QAAQ,IAAI;IAChB,IAAIA,QAAQ,CAACC,IAAI,EAAE;MACjB,MAAMC,OAAO,GAAGF,QAAQ,CAACC,IAAI,CAACE,SAAS,CAAC,CAAC;MACzC,OAAOD,OAAO,CAACE,IAAI,CAAC,CAAC;IACvB,CAAC,MAAM;MACJ,MAAMX,MAAM,CAACO,QAAQ,CAAC;IACzB;EACF,CAAC,CAAC,CACDD,IAAI,CAACM,MAAM,IAAI;IACd,MAAMC,IAAI,GAAGC,MAAM,CAACC,YAAY,CAAC,GAAGH,MAAM,CAACI,KAAK,CAAC;IACjD,OAAOC,kBAAG,CAACC,KAAK,CAACL,IAAI,EAAE;MAAEM,MAAM,EAAE;IAAK,CAAC,CAAC;EAC1C,CAAC,CAAC,CACDb,IAAI,CAACc,IAAI,IAAI;IACZ,IAAIxB,eAAe,CAACwB,IAAI,CAAC,EAAE;MACzBzB,OAAO,CAAC;QAAEyB,IAAI;QAAE1B,MAAM;QAAEG;MAAY,CAAC,CAAC;MACtCM,OAAO,CAACD,QAAQ,CAAC;IACnB,CAAC,MAAM;MACL,MAAMD,UAAU,CAAC,CAAC;IACpB;EACF,CAAC,CAAC,CACDoB,KAAK,CAACC,KAAK,IAAI;IACdxB,OAAO,CAAC;MAAEwB,KAAK;MAAE5B,MAAM;MAAEK;IAAS,CAAC,CAAC;IACrCK,YAAY,CAACF,QAAQ,CAAC;EACxB,CAAC,CAAC;AAAA;AAAC,IAAAqB,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAESlC,cAAc","ignoreList":[]}