{"version":3,"file":"browserStore.js","names":["_storeApi","require","_Type","_fnFetch","_interopRequireDefault","_fnCatch","_createMenu","_createBrowserDynamic","_browserFn","_dialogFn","_compStore","_crMsBrowser","_selectMsBrowser","fCrStoreSlice","_crMsBrowserDynamic","_selectMsBrowserDynamic","_crMsBrowserDynamicElBrowser","fCrMsFromPropNames","_crMsBrowserDynamicBrowserType","_crStore","_browserStore","createStoreWithSelector","_set","getStoreApi","useMsBrowser","exports","fCrUse","showBrowser","id","showWatch","bindTo","BT","WATCH_LIST","showDbWatch","WATCH_LIST_DB","useMsBrowserDynamic","showBrowserDynamic","option","browserType","getBrowserMenu","elBrowser","createBrowserDynamic","setBrowserMenu","_fetchSourceMenu","_ref","json","onCompleted","menu","items","_loadBrowserDynamicCompleted","_ref2","menuItems","createBrowserMenu","setDialogItems","_loadBrowserDynamicFailed","alertItemId","caption","showAlert","loadBrowserDynamic","fnFetch","uri","sourceMenuUrl","onCheckResponse","onFetch","onCatch","fnCatch","onFailed","updateBrowserMenu"],"sources":["../../src/flux/browserStore.js"],"sourcesContent":["import {\r\n  createStoreWithSelector,\r\n  getStoreApi,\r\n  fCrStoreSlice,\r\n  fCrMsFromPropNames,\r\n  fCrUse,\r\n  bindTo\r\n} from './storeApi';\r\n\r\nimport { BrowserType as BT } from '../constants/Type';\r\n\r\nimport fnFetch from '../network/fnFetch';\r\nimport fnCatch from '../network/fnCatch';\r\n\r\nimport createBrowserMenu from './stores/browser/createMenu';\r\nimport createBrowserDynamic from './logic/createBrowserDynamic';\r\n\r\nimport {\r\n  setBrowserMenu,\r\n  getBrowserMenu\r\n} from './browserFn';\r\nimport { setDialogItems } from './dialogFn';\r\nimport { showAlert } from './compStore';\r\n\r\nconst [\r\n  _crMsBrowser,\r\n  _selectMsBrowser\r\n] = fCrStoreSlice(\"msBrowser\", \"id\")\r\n, [\r\n  _crMsBrowserDynamic,\r\n  _selectMsBrowserDynamic\r\n] = fCrStoreSlice(\"msBrowserDynamic\")\r\n, _crMsBrowserDynamicElBrowser = fCrMsFromPropNames(\r\n   _crMsBrowserDynamic,\r\n   \"elBrowser\"\r\n )\r\n, _crMsBrowserDynamicBrowserType = fCrMsFromPropNames(\r\n  _crMsBrowserDynamic,\r\n  \"browserType\",\r\n  \"menuItems\"\r\n);\r\n\r\nconst _crStore = () => ({\r\n  ..._crMsBrowser(),\r\n  ..._crMsBrowserDynamic()\r\n})\r\n, _browserStore = createStoreWithSelector(_crStore)\r\n, [_set] = getStoreApi(_browserStore);\r\n\r\nexport const useMsBrowser = fCrUse(_browserStore, _selectMsBrowser)\r\nexport const showBrowser = (id) => _set(_crMsBrowser(id))\r\nexport const showWatch = bindTo(showBrowser, BT.WATCH_LIST)\r\nexport const showDbWatch = bindTo(showBrowser, BT.WATCH_LIST_DB)\r\n\r\nexport const useMsBrowserDynamic = fCrUse(_browserStore, _selectMsBrowserDynamic)\r\nexport const showBrowserDynamic = (option) => {\r\n  const { browserType } = option;\r\n  if (!getBrowserMenu(browserType)) {\r\n     const elBrowser = createBrowserDynamic(option);\r\n     setBrowserMenu(browserType)\r\n     _set(_crMsBrowserDynamicElBrowser(\r\n       elBrowser\r\n     ))\r\n  } else {\r\n     _set(_crMsBrowserDynamicBrowserType(\r\n       browserType\r\n     ))\r\n  }\r\n}\r\n\r\nconst _fetchSourceMenu = ({\r\n  json,\r\n  option,\r\n  onCompleted\r\n}) => {\r\n  const {\r\n    menu,\r\n    items\r\n  } = json\r\n  , {\r\n    browserType\r\n  } = option;\r\n  onCompleted({ menu, items, browserType });\r\n};\r\nconst _loadBrowserDynamicCompleted = ({\r\n  menu,\r\n  items,\r\n  browserType\r\n}) => {\r\n  const menuItems = createBrowserMenu(\r\n    menu,\r\n    items,\r\n    browserType\r\n  );\r\n  setDialogItems(browserType, items)\r\n  setBrowserMenu(browserType, menuItems)\r\n  _set(_crMsBrowserDynamicBrowserType(\r\n    browserType,\r\n    menuItems\r\n  ))\r\n}\r\n, _loadBrowserDynamicFailed = (option) => {\r\n  option.alertItemId = option.alertItemId\r\n    || option.caption || '';\r\n  showAlert(option)\r\n}\r\nexport const loadBrowserDynamic = (option) => {\r\n  fnFetch({\r\n    uri: option.sourceMenuUrl,\r\n    option: option,\r\n    onCheckResponse: (json) => true,\r\n    onFetch: _fetchSourceMenu,\r\n    onCompleted: _loadBrowserDynamicCompleted,\r\n    onCatch: fnCatch,\r\n    onFailed: _loadBrowserDynamicFailed\r\n  })\r\n}\r\nexport const updateBrowserMenu = (browserType) => {\r\n  _set(_crMsBrowserDynamicBrowserType(\r\n    browserType,\r\n    getBrowserMenu(browserType)\r\n  ))\r\n}\r\n"],"mappings":"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","ignoreList":[]}