{"version":3,"file":"storeApi.js","names":["_zustandLite","require","_bindTo","exports","bindTo","_useSubscribe","_interopRequireDefault","_useRerender","_isFn","v","createStoreWithSelector","crStore","createStore","subscribeWithSelector","getStoreApi","store","setState","getState","fCrStoreSlice","slicePn","optionPn","value","state","fCrMsFromPropNames","crMs","_len","arguments","length","optionNames","Array","_key","_len2","optionValues","_key2","reduce","r","pn","i","fCrMsFromFn","fn","fCrUse","select","isSameValue","useSubscribe","_reducerUseAtomValue","crOrValue","atom","initialValue","_atom","Object","create","useAtomValue","rerender","useRerender","setValue","_prev","_rerender"],"sources":["../../src/flux/storeApi.js"],"sourcesContent":["import {\r\n  createStore,\r\n  subscribeWithSelector\r\n} from './zustand-lite';\r\n\r\nimport { bindTo } from '../utils/bindTo';\r\n\r\nimport useSubscribe from '../components/hooks/useSubscribe';\r\nimport useRerender from '../components/hooks/useRerender';\r\n\r\nexport { bindTo } from '../utils/bindTo';\r\n\r\nconst _isFn = v => typeof v === \"function\";\r\n\r\nexport const createStoreWithSelector = (\r\n  crStore\r\n) => createStore(\r\n  subscribeWithSelector(crStore)\r\n)\r\n\r\nexport const getStoreApi = store => [\r\n  store.setState,\r\n  store.getState\r\n];\r\n\r\nexport const fCrStoreSlice = (\r\n  slicePn,\r\n  optionPn\r\n) => [\r\n  (value) => ({\r\n    [slicePn]: optionPn\r\n      ? {[optionPn]: value}\r\n      : value\r\n  }),\r\n  state => state[slicePn]\r\n];\r\n\r\nexport const fCrMsFromPropNames = (\r\n  crMs,\r\n  ...optionNames\r\n) => (\r\n  ...optionValues\r\n) => crMs(optionNames.reduce((r, pn, i) => {\r\n  r[pn] = optionValues[i]\r\n  return r;\r\n}, {}))\r\n\r\nexport const fCrMsFromFn = (\r\n  crMs,\r\n  fn\r\n) => (...args) => crMs(fn(...args))\r\n\r\nexport const fCrUse = (\r\n  store,\r\n  select,\r\n  isSameValue\r\n) => bindTo(useSubscribe,\r\n  store,\r\n  select  \r\n);\r\n\r\nconst _reducerUseAtomValue = (\r\n  value,\r\n  crOrValue\r\n) => _isFn(crOrValue)\r\n  ? crOrValue(value)\r\n  : crOrValue;\r\nexport const atom = (initialValue) => {\r\n   const _atom = Object.create(null);\r\n   _atom.value = initialValue\r\n   return {\r\n     useAtomValue: () => {\r\n       _atom.rerender = useRerender()\r\n       return _atom.value;\r\n     },\r\n     setValue: (crOrValue) => {\r\n       const _prev = _atom.value\r\n       , _rerender = _atom.rerender;\r\n       _atom.value = _reducerUseAtomValue(_prev, crOrValue)\r\n       if (_prev !== _atom.value && _isFn(_rerender)) {\r\n         _rerender()\r\n       }\r\n     }\r\n   };\r\n}\r\n"],"mappings":"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","ignoreList":[]}