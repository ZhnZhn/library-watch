{"version":3,"sources":["../../../src/components/factories/fNpmDownloads.js"],"names":["MAX_ITEMS","_fnTransformDownloads","downloads","day","labels","data","itemLen","length","fromDate","toDate","itemStep","Math","round","sumDownloads","forEach","item","index","date","value","split","y","m","d","isWeekend","push","fNpmDownloads","factory","option","json","parentProps","onCloseItem","onWatchItem","repo","requestType","chartType","browserType","key","createElement","packageName","package","caption","bind"],"mappings":"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","file":"fNpmDownloads.js","sourcesContent":["\r\nimport DateUtils from '../../utils/DateUtils';\r\n\r\nimport NpmRecentMonthDownloads from '../items/NpmRecentMonthDownloads';\r\n\r\nconst MAX_ITEMS = 30;\r\n\r\nconst _fnTransformDownloads = (downloads=[{ day: '0-0-0', downloads : 0}]) => {\r\n    const labels = []\r\n        , data = []\r\n        , itemLen = downloads.length\r\n        , fromDate = downloads[0].day\r\n        , toDate = downloads[itemLen-1].day\r\n        , itemStep = (itemLen > MAX_ITEMS)\r\n            ? Math.round(itemLen/MAX_ITEMS)\r\n            : 1;\r\n    let sumDownloads = 0;\r\n\r\n    downloads.forEach((item, index) => {\r\n      const { day:date, downloads:value } = item\r\n          , [ y, m, d ] = date.split('-');\r\n\r\n      if ( index % itemStep === 0) {\r\n         if ( !DateUtils.isWeekend(y, m, d) ){\r\n           labels.push(`${m}-${d}`);\r\n           data.push(value);\r\n         } else if (index-2>-1) {\r\n           const item = downloads[index-2]\r\n              , { day:date, downloads:value } = item\r\n           /* eslint-disable no-unused-vars */\r\n               , [ y, m, d ] = date.split('-');\r\n           /* eslint-disable no-unused-vars */\r\n           labels.push(`${m}-${d}`);\r\n           data.push(value);\r\n         }\r\n      }\r\n\r\n      sumDownloads = sumDownloads + value;\r\n    })\r\n\r\n    return {sumDownloads, fromDate, toDate, labels, data};\r\n}\r\n\r\nconst fNpmDownloads = function({\r\n  factory, option, json, parentProps, onCloseItem, onWatchItem\r\n}){\r\n  const { repo, requestType, chartType, browserType } = option\r\n      , { downloads } = json\r\n      , { sumDownloads, fromDate, toDate, labels, data } = _fnTransformDownloads(downloads)\r\n      , key = `${repo}_${requestType}_${fromDate}`\r\n\r\n  return factory.createElement(NpmRecentMonthDownloads, {\r\n     key : key,\r\n     packageName : json.package,\r\n     requestType : requestType,\r\n     caption : json.package,\r\n     sumDownloads : sumDownloads,\r\n     fromDate : fromDate,\r\n     toDate : toDate,\r\n     labels : labels,\r\n     data : data,\r\n     onCloseItem : onCloseItem.bind(null, chartType, browserType, key),\r\n     //onWatchItem : onWatchItem,\r\n     ...parentProps\r\n  })\r\n};\r\n\r\nexport default fNpmDownloads\r\n"]}