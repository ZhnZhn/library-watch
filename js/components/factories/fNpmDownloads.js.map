{"version":3,"file":"fNpmDownloads.js","names":["_fNpm","_interopRequireDefault","require","_dateFn","MAX_ITEMS","_trimRecentZeroValue","data","labels","_indexRecent","length","splice","_transformDownloads","downloads","day","itemLen","fromDate","toDate","itemStep","Math","round","sumDownloads","forEach","item","index","date","value","y","m","d","split","isWeekend","push","fNpmDownloads","fNpm","_default","exports","default"],"sources":["../../../src/components/factories/fNpmDownloads.js"],"sourcesContent":["import fNpm from './fNpm';\r\nimport { isWeekend } from '../../utils/dateFn';\r\n\r\nconst MAX_ITEMS = 30;\r\n\r\nconst _trimRecentZeroValue = (\r\n  data,\r\n  labels\r\n) => {\r\n  const _indexRecent = data.length-1;\r\n  if (_indexRecent >= 0 && data[_indexRecent] === 0) {\r\n    data.splice(_indexRecent)\r\n    labels.splice(_indexRecent)\r\n  }\r\n};\r\n\r\n/* Irregular Time Inrevals */\r\nconst _transformDownloads = (\r\n  downloads=[{ day: '1970-01-01', downloads : 0}]\r\n) => {\r\n    const labels = []\r\n    , data = []\r\n    , itemLen = downloads.length\r\n    , fromDate = downloads[0].day\r\n    , toDate = itemLen > 0\r\n        ? downloads[itemLen-1].day\r\n        : fromDate\r\n    , itemStep = itemLen > MAX_ITEMS\r\n        ? Math.round(itemLen/MAX_ITEMS)\r\n        : 1;\r\n    let sumDownloads = 0;\r\n\r\n    downloads.forEach((item, index) => {\r\n      const {\r\n        day:date,\r\n        downloads:value\r\n      } = item\r\n      , [y, m, d] = date.split('-');\r\n\r\n      if ( index % itemStep === 0) {\r\n         if ( !isWeekend(y, m, d) ){\r\n           labels.push(`${m}-${d}`);\r\n           data.push(value);\r\n         } else if (index-2>-1) {\r\n           const item = downloads[index-2]\r\n           , { day:date, downloads:value } = item\r\n           /* eslint-disable no-unused-vars */\r\n           , [y, m, d] = date.split('-');\r\n           /* eslint-disable no-unused-vars */\r\n           labels.push(`${m}-${d}`);\r\n           data.push(value);\r\n         }\r\n      }\r\n      sumDownloads += value;\r\n    })\r\n\r\n    _trimRecentZeroValue(data, labels)\r\n\r\n    return {\r\n      sumDownloads,\r\n      fromDate,\r\n      toDate,\r\n      labels,\r\n      data\r\n    };\r\n};\r\n\r\nconst fNpmDownloads = fNpm(_transformDownloads);\r\n\r\nexport default fNpmDownloads\r\n"],"mappings":";;;;;AAAA,IAAAA,KAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,OAAA,GAAAD,OAAA;AAEA,MAAME,SAAS,GAAG,EAAE;AAEpB,MAAMC,oBAAoB,GAAGA,CAC3BC,IAAI,EACJC,MAAM,KACH;EACH,MAAMC,YAAY,GAAGF,IAAI,CAACG,MAAM,GAAC,CAAC;EAClC,IAAID,YAAY,IAAI,CAAC,IAAIF,IAAI,CAACE,YAAY,CAAC,KAAK,CAAC,EAAE;IACjDF,IAAI,CAACI,MAAM,CAACF,YAAY,CAAC;IACzBD,MAAM,CAACG,MAAM,CAACF,YAAY,CAAC;EAC7B;AACF,CAAC;;AAED;AACA,MAAMG,mBAAmB,GAAG,SAAAA,CAC1BC,SAAS,EACN;EAAA,IADHA,SAAS;IAATA,SAAS,GAAC,CAAC;MAAEC,GAAG,EAAE,YAAY;MAAED,SAAS,EAAG;IAAC,CAAC,CAAC;EAAA;EAE7C,MAAML,MAAM,GAAG,EAAE;IACfD,IAAI,GAAG,EAAE;IACTQ,OAAO,GAAGF,SAAS,CAACH,MAAM;IAC1BM,QAAQ,GAAGH,SAAS,CAAC,CAAC,CAAC,CAACC,GAAG;IAC3BG,MAAM,GAAGF,OAAO,GAAG,CAAC,GAChBF,SAAS,CAACE,OAAO,GAAC,CAAC,CAAC,CAACD,GAAG,GACxBE,QAAQ;IACZE,QAAQ,GAAGH,OAAO,GAAGV,SAAS,GAC1Bc,IAAI,CAACC,KAAK,CAACL,OAAO,GAACV,SAAS,CAAC,GAC7B,CAAC;EACP,IAAIgB,YAAY,GAAG,CAAC;EAEpBR,SAAS,CAACS,OAAO,CAAC,CAACC,IAAI,EAAEC,KAAK,KAAK;IACjC,MAAM;QACJV,GAAG,EAACW,IAAI;QACRZ,SAAS,EAACa;MACZ,CAAC,GAAGH,IAAI;MACN,CAACI,CAAC,EAAEC,CAAC,EAAEC,CAAC,CAAC,GAAGJ,IAAI,CAACK,KAAK,CAAC,GAAG,CAAC;IAE7B,IAAKN,KAAK,GAAGN,QAAQ,KAAK,CAAC,EAAE;MAC1B,IAAK,CAAC,IAAAa,iBAAS,EAACJ,CAAC,EAAEC,CAAC,EAAEC,CAAC,CAAC,EAAE;QACxBrB,MAAM,CAACwB,IAAI,CAAC,GAAGJ,CAAC,IAAIC,CAAC,EAAE,CAAC;QACxBtB,IAAI,CAACyB,IAAI,CAACN,KAAK,CAAC;MAClB,CAAC,MAAM,IAAIF,KAAK,GAAC,CAAC,GAAC,CAAC,CAAC,EAAE;QACrB,MAAMD,IAAI,GAAGV,SAAS,CAACW,KAAK,GAAC,CAAC,CAAC;UAC7B;YAAEV,GAAG,EAACW,IAAI;YAAEZ,SAAS,EAACa;UAAM,CAAC,GAAGH;UAClC;UACE,CAACI,CAAC,EAAEC,CAAC,EAAEC,CAAC,CAAC,GAAGJ,IAAI,CAACK,KAAK,CAAC,GAAG,CAAC;QAC7B;QACAtB,MAAM,CAACwB,IAAI,CAAC,GAAGJ,CAAC,IAAIC,CAAC,EAAE,CAAC;QACxBtB,IAAI,CAACyB,IAAI,CAACN,KAAK,CAAC;MAClB;IACH;IACAL,YAAY,IAAIK,KAAK;EACvB,CAAC,CAAC;EAEFpB,oBAAoB,CAACC,IAAI,EAAEC,MAAM,CAAC;EAElC,OAAO;IACLa,YAAY;IACZL,QAAQ;IACRC,MAAM;IACNT,MAAM;IACND;EACF,CAAC;AACL,CAAC;AAED,MAAM0B,aAAa,GAAG,IAAAC,aAAI,EAACtB,mBAAmB,CAAC;AAAC,IAAAuB,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAEjCJ,aAAa","ignoreList":[]}