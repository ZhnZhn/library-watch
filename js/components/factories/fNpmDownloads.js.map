{"version":3,"sources":["../../../src/components/factories/fNpmDownloads.js"],"names":["MAX_ITEMS","_fnTransformDownloads","downloads","day","labels","data","itemLen","length","fromDate","toDate","itemStep","Math","round","sumDownloads","forEach","item","index","date","value","split","y","m","d","DateUtils","isWeekend","push","fNpmDownloads","factory","option","json","parentProps","onCloseItem","onWatchItem","repo","requestType","chartType","browserType","packageName","package","key","createElement","NpmRecentMonthDownloads","caption","bind"],"mappings":"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","file":"fNpmDownloads.js","sourcesContent":["\r\nimport DateUtils from '../../utils/DateUtils';\r\n\r\nimport NpmRecentMonthDownloads from '../items/NpmRecentMonthDownloads';\r\n\r\nconst MAX_ITEMS = 30;\r\n\r\n/* Irregular Time Inrevals */\r\nconst _fnTransformDownloads = (downloads=[{ day: '1970-01-01', downloads : 0}]) => {\r\n    const labels = []\r\n        , data = []\r\n        , itemLen = downloads.length\r\n        , fromDate = downloads[0].day\r\n        , toDate = itemLen > 0\r\n            ? downloads[itemLen-1].day\r\n            : fromDate\r\n        , itemStep = itemLen > MAX_ITEMS\r\n            ? Math.round(itemLen/MAX_ITEMS)\r\n            : 1;\r\n    let sumDownloads = 0;\r\n\r\n    downloads.forEach((item, index) => {\r\n      const { day:date, downloads:value } = item\r\n          , [ y, m, d ] = date.split('-');\r\n\r\n      if ( index % itemStep === 0) {\r\n         if ( !DateUtils.isWeekend(y, m, d) ){\r\n           labels.push(`${m}-${d}`);\r\n           data.push(value);\r\n         } else if (index-2>-1) {\r\n           const item = downloads[index-2]\r\n              , { day:date, downloads:value } = item\r\n           /* eslint-disable no-unused-vars */\r\n              , [ y, m, d ] = date.split('-');\r\n           /* eslint-disable no-unused-vars */\r\n           labels.push(`${m}-${d}`);\r\n           data.push(value);\r\n         }\r\n      }\r\n\r\n      sumDownloads += value;\r\n    })\r\n\r\n    return {sumDownloads, fromDate, toDate, labels, data};\r\n}\r\n\r\n\r\nconst fNpmDownloads = function({\r\n  factory, option, json, parentProps, onCloseItem, onWatchItem\r\n}){\r\n  const { repo, requestType, chartType, browserType } = option\r\n      , { downloads, package:packageName } = json\r\n      , { sumDownloads, fromDate, toDate, labels, data } = _fnTransformDownloads(downloads)\r\n      , key = `${repo}_${requestType}_${fromDate}`;\r\n\r\n  return factory.createElement(NpmRecentMonthDownloads, {\r\n     key,\r\n     packageName,\r\n     caption: packageName,\r\n     requestType,\r\n     sumDownloads,\r\n     fromDate,\r\n     toDate,\r\n     labels,\r\n     data,\r\n     onCloseItem : onCloseItem.bind(null, chartType, browserType, key),\r\n     //onWatchItem : onWatchItem,\r\n     ...parentProps\r\n  })\r\n};\r\n\r\nexport default fNpmDownloads\r\n"]}