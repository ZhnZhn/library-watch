{"version":3,"sources":["../../../src/components/zhn-moleculs/DraggableDialog.jsx"],"names":["CL","ROOT","SHOWING","NOT_SELECTED","MENU_MORE","S","STYLE","ROOT_DIV_DRAG","position","top","left","zIndex","BT_MORE","BT_MORE_SVG","stroke","fill","CHILDREN_DIV","cursor","_isFn","fn","DraggableDialog","state","isMore","_hKeyDown","evt","preventDefault","stopPropagation","_hClose","props","onClose","focusPrev","_toggleMore","setState","prevState","_renderMenuMore","menuModel","_renderBtMore","_refBtMore","_renderCommandButton","commandButtons","onShowChart","COMMAND_DIV","BT_ROOT","node","btMore","_refRootDiv","rootDiv","componentDidMount","Interact","makeDragable","focus","_hasShowed","prevProps","isShow","componentDidUpdate","render","caption","children","onFront","_styleShow","SHOW","HIDE","_classShow","_className","ROOT_DIV","CAPTION_DIV","SVG_CLOSE","_prevFocused","document","activeElement","Component","defaultProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\n//import PropTypes from \"prop-types\";\r\n\r\nimport {\r\n  isKeyEscape,\r\n  focusNode\r\n} from '../zhn-utils/utils'\r\n\r\nimport ModalSlider from '../zhn-modal-slider/ModalSlider'\r\nimport SvgMore from '../zhn-atoms/SvgMore';\r\nimport SvgClose from '../zhn-atoms/SvgClose';\r\nimport FlatButton from '../zhn-m/FlatButton'\r\n\r\nimport Interact from '../../utils/Interact'\r\n\r\nimport STYLE from './Dialog.Style'\r\n\r\nconst CL = {\r\n  ROOT: \"draggable-dialog\",\r\n  SHOWING: 'show-popup',\r\n  NOT_SELECTED: 'not-selected',\r\n  MENU_MORE: 'popup-menu dialog__menu-more'\r\n};\r\n\r\nconst S = {\r\n  ...STYLE,\r\n  ROOT_DIV_DRAG: {\r\n    position: 'absolute',\r\n    top: '30px',\r\n    left: '50px',\r\n    zIndex: 10\r\n  },\r\n  BT_MORE: {\r\n    position: 'absolute',\r\n    left: 0\r\n  },\r\n  BT_MORE_SVG: {\r\n    stroke: 'inherit',\r\n    fill: 'inherit'\r\n  },\r\n  CHILDREN_DIV: {\r\n    cursor: 'default'\r\n  }\r\n};\r\n\r\nconst _isFn = fn => typeof fn === 'function';\r\n\r\nclass DraggableDialog extends Component {\r\n  /*\r\n  static propTypes = {\r\n    isShow: PropTypes.bool,\r\n    caption: PropTypes.string,\r\n    children: PropTypes.oneOfType([\r\n      PropTypes.arrayOf(PropTypes.node),\r\n      PropTypes.node\r\n    ]),\r\n    commandButtons: PropTypes.arrayOf(PropTypes.element),\r\n    onShowChart: PropTypes.func,\r\n    onClose: PropTypes.func\r\n  }\r\n  */\r\n  static defaultProps = {\r\n    onClose: () => {}\r\n  }\r\n\r\n  state = {\r\n    isMore: false\r\n  }\r\n\r\n  componentDidMount(){\r\n     Interact.makeDragable(this.rootDiv);\r\n     this.focus()\r\n  }\r\n\r\n  _hasShowed(prevProps) {\r\n    return !prevProps.isShow\r\n      && this.props.isShow;\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if ( this._hasShowed(prevProps) ) {\r\n      this.focus()\r\n    }\r\n  }\r\n\r\n  _hKeyDown = evt => {\r\n    if ( isKeyEscape(evt) ) {\r\n      evt.preventDefault()\r\n      evt.stopPropagation()\r\n      this._hClose()\r\n    }\r\n  }\r\n  _hClose = () => {\r\n     this.props.onClose()\r\n     this.focusPrev()\r\n  }\r\n\r\n  _toggleMore = () => {    \r\n    this.setState(prevState => ({\r\n      isMore: !prevState.isMore\r\n    }))\r\n  }\r\n\r\n  _renderMenuMore = (menuModel, isMore) => {\r\n     return menuModel && <ModalSlider\r\n      isShow={isMore}\r\n      className={CL.MENU_MORE}\r\n      //style={TS.EL_BORDER}\r\n      model={menuModel}\r\n      onClose={this._toggleMore}\r\n    />\r\n  }\r\n\r\n  _renderBtMore = (menuModel) => {\r\n    return menuModel && <SvgMore\r\n      btRef={this._refBtMore}\r\n      style={S.BT_MORE}\r\n      svgStyle={S.BT_MORE_SVG}\r\n      onClick={this._toggleMore}\r\n    />\r\n  }\r\n\r\n  _renderCommandButton = (commandButtons, onShowChart, onClose) => {\r\n    return (\r\n      <div style={S.COMMAND_DIV}>\r\n        {commandButtons}\r\n        {\r\n          _isFn(onShowChart) && <FlatButton\r\n            key=\"show\"\r\n            rootStyle={S.BT_ROOT}\r\n            caption=\"Show\"\r\n            title=\"Show Pane Container\"\r\n            //accessKey=\"s\"\r\n            onClick={onShowChart}\r\n          />\r\n        }\r\n        <FlatButton\r\n          key=\"close\"\r\n          rootStyle={S.BT_ROOT}\r\n          caption=\"Close\"\r\n          title=\"Close Draggable Dialog\"\r\n          //accessKey=\"c\"\r\n          onClick={onClose}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  _refBtMore = node => this.btMore = node\r\n  _refRootDiv = node => this.rootDiv = node\r\n\r\n\r\n  render(){\r\n    const {\r\n       menuModel,\r\n       isShow, caption, children,\r\n       commandButtons,\r\n       onShowChart, onFront\r\n     } = this.props\r\n    , { isMore } = this.state\r\n    , _styleShow = isShow ? S.SHOW : S.HIDE\r\n    , _classShow = isShow ? CL.SHOWING : ''\r\n    , _className = `${CL.ROOT} ${_classShow}`;\r\n    return (\r\n  /*eslint-disable jsx-a11y/no-noninteractive-element-interactions*/\r\n      <div\r\n        ref={this._refRootDiv}\r\n        role=\"dialog\"\r\n        tabIndex=\"-1\"\r\n        aria-label={caption}\r\n        aria-hidden={!isShow}\r\n        className={_className}\r\n        style={{\r\n          ...S.ROOT_DIV, ...S.ROOT_DIV_DRAG,\r\n          ..._styleShow\r\n        }}\r\n        onClick={onFront}\r\n        onKeyDown={this._hKeyDown}\r\n       >\r\n    {/*eslint-enable jsx-a11y/no-noninteractive-element-interactions*/}\r\n        <div style={S.CAPTION_DIV}>\r\n          { this._renderMenuMore(menuModel, isMore) }\r\n          { this._renderBtMore(menuModel) }\r\n          <span className={CL.NOT_SELECTED}>\r\n            {caption}\r\n          </span>\r\n          <SvgClose\r\n             style={S.SVG_CLOSE}\r\n             onClose={this._hClose}\r\n          />\r\n        </div>\r\n        <div style={S.CHILDREN_DIV}>\r\n           {children}\r\n        </div>\r\n        {this._renderCommandButton(commandButtons, onShowChart, this._hClose)}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  focus() {\r\n    this._prevFocused = document.activeElement\r\n    focusNode(this.btMore || this.rootDiv)\r\n  }\r\n\r\n  focusPrev() {\r\n    focusNode(this._prevFocused)\r\n    this._prevFocused = null\r\n  }\r\n\r\n}\r\n\r\nexport default DraggableDialog\r\n"],"file":"DraggableDialog.js"}