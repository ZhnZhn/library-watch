{"version":3,"sources":["../../../src/components/items/NpmRecentMonthDownloads.jsx"],"names":["BASE_NODEICO","SUFFIX_NODEICO","BASE_NPM","ITEM_DESCRIPTION","S","ROOT","position","lineHeight","marginBottom","marginRight","CAPTION_OPEN","top","display","color","paddingLeft","maxWidth","fontWeight","whiteSpace","textOverflow","overflow","cursor","CAPTION","BT_MORE","verticalAlign","SPAN_SUM","paddingRight","SPAN_START","BTN_CIRCLE","marginLeft","ML_32","MT_16","marginTop","MB_16","SPAN_NODEICO","BUTTON_DOWN_UP","paddingTop","paddingBottom","_isFn","fn","NpmRecentDownloads","props","_hClickMore","setState","isMore","_hToggleMore","prevState","_toggleButtons","isButtons","_handlerToggleOpen","isShow","state","_handlerClickWatch","packageName","requestType","sumDownloads","toDate","onWatchItem","_caption","_descr","caption","config","repo","descr","version","date","_handlerClickNodeIco","isLoadNodeIco","isShowNodeIco","_hClickNpms","onLoad","_onLoadNpms","json","npmsJson","isLoadedNpms","isShowNmps","_toggleNpms","_renderButtonWatch","_renderNodeIcoBadge","_href","_imgSrc","onMoveToTop","_MORE","onToggleButtons","fromDate","labels","data","onCloseItem","_lineChartConfig","Chart","fLineConfig","_onClickNpms","_infoStyle","CL","MENU_MORE","Component"],"mappings":"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","file":"NpmRecentMonthDownloads.js","sourcesContent":["import React, { Component } from 'react'\r\n\r\nimport Chart from '../charts/Chart'\r\n\r\nimport crModelMore from './crNpmModelMore'\r\n\r\nimport loadNpms from './loadNpms'\r\n\r\nimport A from '../zhn-atoms/A'\r\nimport ModalSlider from '../zhn-modal-slider/ModalSlider'\r\nimport LineChart from '../charts/LineChart'\r\nimport Caption from './ItemCaption'\r\nimport PackageDetails from './PackageDetails'\r\n\r\nimport CL from '../styles/CL'\r\n\r\nconst BASE_NODEICO = \"https://nodei.co/npm/\"\r\n    , SUFFIX_NODEICO = \".png?downloads=true&downloadRank=true&stars=true\"\r\n    , BASE_NPM = \"https://www.npmjs.com/package/\"\r\n    , ITEM_DESCRIPTION = \"Npm Recent Month Downloads\";\r\n\r\nconst S = {\r\n  ROOT: {\r\n    position: 'relative',\r\n    lineHeight: 1.5,\r\n    marginBottom: 10,\r\n    marginRight: 25\r\n  },\r\n  CAPTION_OPEN: {\r\n    position: 'relative',\r\n    top: -6,\r\n    display: 'inline-block',\r\n    color: '#a487d4',\r\n    paddingLeft: 8,\r\n    maxWidth: 500,\r\n    fontWeight : 'bold',\r\n    whiteSpace: 'nowrap',\r\n    textOverflow : 'ellipsis',\r\n    overflow : 'hidden',\r\n    cursor: 'pointer'\r\n  },\r\n  CAPTION: {\r\n    paddingLeft: 4,\r\n  },\r\n  BT_MORE: {\r\n    verticalAlign: 'none'\r\n  },\r\n\r\n  SPAN_SUM: {\r\n    color: '#80c040',\r\n    paddingLeft: 10,\r\n    paddingRight: 10\r\n  },\r\n  SPAN_START: {\r\n    paddingRight: 10\r\n  },\r\n  BTN_CIRCLE: {\r\n    position: 'relative',\r\n    top: -6,\r\n    marginLeft: 10\r\n  },\r\n\r\n  ML_32: {\r\n    marginLeft: 32\r\n  },\r\n  MT_16: {\r\n    marginTop: 16\r\n  },\r\n  MB_16: {\r\n    marginBottom: 16\r\n  },\r\n\r\n  SPAN_NODEICO: {\r\n    display: 'block',\r\n    fontWeight: 'bold' ,\r\n    color: '#3399FF',\r\n    cursor: 'pointer'\r\n  },\r\n\r\n  BUTTON_DOWN_UP: {\r\n    paddingTop: 4,\r\n    paddingBottom: 4\r\n  }\r\n\r\n};\r\n\r\n\r\nconst _isFn = fn => typeof fn === 'function';\r\n\r\nclass NpmRecentDownloads extends Component {\r\n\r\n  constructor(props){\r\n    super(props)\r\n    const { onMoveToTop } = props;\r\n    this._MORE = crModelMore({\r\n      onMoveToTop,\r\n      onToggleButtons: this._toggleButtons\r\n    })\r\n    this.state = {\r\n      isShow: true,\r\n      isMore: false,\r\n      isButtons: true,\r\n      isLoadNodeIco: false,\r\n      isShowNodeIco: false,\r\n      isLoadedNpms: false,\r\n      isShowNmps: false\r\n    }\r\n  }\r\n\r\n  _hClickMore = () => {\r\n    this.setState({ isMore: true })\r\n  }\r\n  _hToggleMore = () => {\r\n    this.setState(prevState => ({\r\n      isMore: !prevState.isMore\r\n    }))\r\n  }\r\n  _toggleButtons = () => {\r\n    this.setState(prevState => ({\r\n      isButtons: !prevState.isButtons\r\n    }))\r\n  }\r\n\r\n  _handlerToggleOpen = () => {\r\n    this.setState({ isShow : !this.state.isShow });\r\n  }\r\n  _handlerClickWatch = () => {\r\n    const { packageName, requestType, sumDownloads, toDate, onWatchItem } = this.props\r\n        , _caption = `${packageName} ${sumDownloads}`\r\n        , _descr = ITEM_DESCRIPTION\r\n    onWatchItem({\r\n       caption : _caption,\r\n       config : {\r\n          requestType,\r\n          repo : packageName,\r\n          descr: _descr,\r\n          version : sumDownloads,\r\n          caption : _caption,\r\n          date : toDate\r\n        }\r\n    });\r\n  }\r\n\r\n  _handlerClickNodeIco = () => {\r\n    this.setState({\r\n      isLoadNodeIco : true,\r\n      isShowNodeIco : !this.state.isShowNodeIco\r\n    });\r\n  }\r\n\r\n  _hClickNpms = () => {\r\n    const { packageName } = this.props;\r\n    loadNpms({ packageName, onLoad: this._onLoadNpms })\r\n  }\r\n\r\n  _onLoadNpms = (json) => {\r\n    this.setState({\r\n      npmsJson: json,\r\n      isLoadedNpms: true,\r\n      isShowNmps: true\r\n    })\r\n  }\r\n\r\n  _toggleNpms = () => {\r\n    this.setState(prevState => ({\r\n      isShowNmps: !prevState.isShowNmps\r\n    }))\r\n  }\r\n\r\n  _renderButtonWatch = () => {\r\n    return (\r\n      <A.ButtonCircle\r\n         caption=\"W\"\r\n         title=\"Add to Watch\"\r\n         style={S.BTN_CIRCLE}\r\n         onClick={this._handlerClickWatch}\r\n      />\r\n    )\r\n  }\r\n\r\n  _renderNodeIcoBadge = (packageName) => {\r\n    const _href = BASE_NPM + packageName\r\n        , _imgSrc = BASE_NODEICO + packageName + SUFFIX_NODEICO\r\n    return (\r\n      <A.LinkImg\r\n         href={_href}\r\n         imgClass=\"node-ico\"\r\n         imgSrc={_imgSrc}\r\n      />\r\n    );\r\n  }\r\n\r\n  render(){\r\n    const {\r\n      packageName, caption, sumDownloads=0,\r\n      fromDate, toDate,\r\n      labels, data,\r\n      onCloseItem, onWatchItem\r\n    } = this.props\r\n    , {\r\n      isShow, isMore,\r\n      isButtons,\r\n      isLoadNodeIco, isShowNodeIco,\r\n      isLoadedNpms, isShowNmps, npmsJson\r\n    } = this.state\r\n    , _lineChartConfig = Chart.fLineConfig({ labels, data })\r\n    , _onClickNpms = isLoadedNpms\r\n        ? this._toggleNpms\r\n        : this._hClickNpms\r\n    , _infoStyle = isButtons\r\n          ? { ...S.ML_32, ...S.MT_16 }\r\n          : S.ML_32;\r\n    return (\r\n      <div style={S.ROOT}>\r\n        <ModalSlider\r\n          isShow={isMore}\r\n          className={CL.MENU_MORE}\r\n          model={this._MORE}\r\n          onClose={this._hToggleMore}\r\n        />\r\n        <Caption style={S.CAPTION} onClose={onCloseItem}>\r\n          <A.SvgMore\r\n            style={S.BT_MORE}\r\n            onClick={this._hClickMore}\r\n          />\r\n          <button\r\n             className=\"not-selected\"\r\n             title={caption}\r\n             style={S.CAPTION_OPEN}\r\n             onClick={this._handlerToggleOpen}\r\n          >\r\n            <span>\r\n              {packageName}\r\n            </span>\r\n            <A.FormattedInteger\r\n               value={sumDownloads}\r\n               style={S.SPAN_SUM}\r\n            />\r\n            <span style={S.SPAN_START}>\r\n              {fromDate}\r\n            </span>\r\n            <span>\r\n              {toDate}\r\n            </span>\r\n          </button>\r\n          { _isFn(onWatchItem) && this._renderButtonWatch() }\r\n        </Caption>\r\n        <A.ShowHide isShow={isShow}>\r\n          <LineChart\r\n             data={_lineChartConfig}\r\n          />\r\n\r\n          <A.ShowHide isShow={isButtons} >\r\n           <div style={S.ML_32}>\r\n             <A.ButtonDownUp\r\n               style={S.BUTTON_DOWN_UP}\r\n               isUp={isShowNodeIco}\r\n               caption=\"NodeICO\"\r\n               title=\"Package badge from Nodei.co\"\r\n               onClick={this._handlerClickNodeIco}\r\n             />\r\n             <A.ButtonDownUp\r\n               style={{ ...S.BUTTON_DOWN_UP, marginLeft: 32 }}\r\n               isUp={isShowNmps}\r\n               caption=\"NPMS.IO\"\r\n               title=\"Click to load package info from npms.io\"\r\n               onClick={_onClickNpms}\r\n             />\r\n           </div>\r\n          </A.ShowHide>\r\n\r\n          <div style={_infoStyle}>\r\n            <A.ShowHide isShow={isShowNodeIco} style={S.MB_16}>\r\n              {isLoadNodeIco && this._renderNodeIcoBadge(packageName)}\r\n            </A.ShowHide>\r\n            <A.ShowHide isShow={isShowNmps} style={S.MB_16}>\r\n              {isLoadedNpms && <PackageDetails json={npmsJson} />}\r\n            </A.ShowHide>\r\n          </div>\r\n\r\n        </A.ShowHide>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default NpmRecentDownloads\r\n"]}