{"version":3,"file":"InputFileReader.js","names":["_uiApi","require","_jsxRuntime","CL_FILE_INPUT","INITIAL_FILE_LABEL","FN_NOOP","InputFileReader","_ref","as","onChange","labelText","setLabelText","useState","_hChange","useCallback","e","files","i","target","length","push","Promise","all","map","file","resolve","reject","reader","FileReader","onload","result","toLowerCase","readAsBinaryString","readAsArrayBuffer","readAsText","readAsDataURL","then","zippedResults","_labelText","name","jsxs","className","children","jsx","type","id","htmlFor","xmlns","width","height","viewBox","d","_default","exports","default"],"sources":["../../../src/components/zhn/InputFileReader.jsx"],"sourcesContent":["//import PropTypes from \"prop-types\";\r\nimport { useState, useCallback } from '../uiApi';\r\n\r\nconst CL_FILE_INPUT = \"_react-file-reader-input\"\r\n, INITIAL_FILE_LABEL = \"Choose a file...\"\r\n, FN_NOOP = () => {};\r\n\r\nconst InputFileReader = ({\r\n  as='text',\r\n  onChange=FN_NOOP\r\n}) => {\r\n  const [labelText, setLabelText] = useState(INITIAL_FILE_LABEL)\r\n  /*eslint-disable react-hooks/exhaustive-deps */\r\n  , _hChange = useCallback((e) => {\r\n      const files = [];\r\n      for (let i = 0; i < e.target.files.length; i++) {\r\n        // Convert to Array.\r\n        files.push(e.target.files[i]);\r\n      }\r\n\r\n      // Build Promise List, each promise resolved by FileReader.onload.\r\n      Promise.all(files.map(file => new Promise((resolve, reject) => {\r\n        let reader = new FileReader();\r\n\r\n        reader.onload = result => {\r\n          // Resolve both the FileReader result and its original file.\r\n          resolve([result, file]);\r\n        };\r\n\r\n        // Read the file with format based on this.props.as.\r\n        switch (as.toLowerCase()) {\r\n          case 'binary':\r\n            reader.readAsBinaryString(file);\r\n            break;\r\n          case 'buffer':\r\n            reader.readAsArrayBuffer(file);\r\n            break;\r\n          case 'text':\r\n            reader.readAsText(file);\r\n            break;\r\n          case 'url':\r\n            reader.readAsDataURL(file);\r\n            break;\r\n          default:\r\n            reader.readAsText(file);\r\n        }\r\n      })))\r\n      .then(zippedResults => {\r\n        // Run the callback after all files have been read.\r\n        const _labelText = zippedResults && zippedResults[0]\r\n          ? (zippedResults[0][1] || {}).name\r\n          : INITIAL_FILE_LABEL;\r\n        setLabelText(_labelText)\r\n        onChange(zippedResults)\r\n      });\r\n    }, [])\r\n    // as, onChange\r\n    /*eslint-enable react-hooks/exhaustive-deps */\r\n\r\n  return (\r\n    <div className={CL_FILE_INPUT}>\r\n      <input\r\n        className=\"inputfile\"\r\n        type=\"file\"\r\n        id=\"file\"\r\n        name=\"file\"\r\n        as={as}\r\n        onChange={_hChange}\r\n      />\r\n      <label htmlFor=\"file\">\r\n         <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"17\" viewBox=\"0 0 20 17\"><path d=\"M10 0l-5.2 4.9h3.3v5.1h3.8v-5.1h3.3l-5.2-4.9zm9.3 11.5l-3.2-2.1h-2l3.4 2.6h-3.5c-.1 0-.2.1-.2.1l-.8 2.3h-6l-.8-2.2c-.1-.1-.1-.2-.2-.2h-3.6l3.4-2.6h-2l-3.2 2.1c-.4.3-.7 1-.6 1.5l.6 3.1c.1.5.7.9 1.2.9h16.3c.6 0 1.1-.4 1.3-.9l.6-3.1c.1-.5-.2-1.2-.7-1.5z\"/></svg>\r\n         <span>{labelText}</span>\r\n      </label>\r\n     </div>\r\n  );\r\n};\r\n\r\n/*\r\n InputFileReader.propTypes = {\r\n   as: PropTypes.oneOf([\r\n    'binary',\r\n    'buffer',\r\n    'text',\r\n    'url'\r\n   ])\r\n }\r\n*/\r\n\r\nexport default InputFileReader\r\n"],"mappings":";;;;AACA,IAAAA,MAAA,GAAAC,OAAA;AAAiD,IAAAC,WAAA,GAAAD,OAAA;AADjD;;AAGA,MAAME,aAAa,GAAG,0BAA0B;EAC9CC,kBAAkB,GAAG,kBAAkB;EACvCC,OAAO,GAAGA,CAAA,KAAM,CAAC,CAAC;AAEpB,MAAMC,eAAe,GAAGC,IAAA,IAGlB;EAAA,IAHmB;IACvBC,EAAE,GAAC,MAAM;IACTC,QAAQ,GAACJ;EACX,CAAC,GAAAE,IAAA;EACC,MAAM,CAACG,SAAS,EAAEC,YAAY,CAAC,GAAG,IAAAC,eAAQ,EAACR,kBAAkB;IAC7D;IACES,QAAQ,GAAG,IAAAC,kBAAW,EAAEC,CAAC,IAAK;MAC5B,MAAMC,KAAK,GAAG,EAAE;MAChB,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGF,CAAC,CAACG,MAAM,CAACF,KAAK,CAACG,MAAM,EAAEF,CAAC,EAAE,EAAE;QAC9C;QACAD,KAAK,CAACI,IAAI,CAACL,CAAC,CAACG,MAAM,CAACF,KAAK,CAACC,CAAC,CAAC,CAAC;MAC/B;;MAEA;MACAI,OAAO,CAACC,GAAG,CAACN,KAAK,CAACO,GAAG,CAACC,IAAI,IAAI,IAAIH,OAAO,CAAC,CAACI,OAAO,EAAEC,MAAM,KAAK;QAC7D,IAAIC,MAAM,GAAG,IAAIC,UAAU,CAAC,CAAC;QAE7BD,MAAM,CAACE,MAAM,GAAGC,MAAM,IAAI;UACxB;UACAL,OAAO,CAAC,CAACK,MAAM,EAAEN,IAAI,CAAC,CAAC;QACzB,CAAC;;QAED;QACA,QAAQhB,EAAE,CAACuB,WAAW,CAAC,CAAC;UACtB,KAAK,QAAQ;YACXJ,MAAM,CAACK,kBAAkB,CAACR,IAAI,CAAC;YAC/B;UACF,KAAK,QAAQ;YACXG,MAAM,CAACM,iBAAiB,CAACT,IAAI,CAAC;YAC9B;UACF,KAAK,MAAM;YACTG,MAAM,CAACO,UAAU,CAACV,IAAI,CAAC;YACvB;UACF,KAAK,KAAK;YACRG,MAAM,CAACQ,aAAa,CAACX,IAAI,CAAC;YAC1B;UACF;YACEG,MAAM,CAACO,UAAU,CAACV,IAAI,CAAC;QAC3B;MACF,CAAC,CAAC,CAAC,CAAC,CACHY,IAAI,CAACC,aAAa,IAAI;QACrB;QACA,MAAMC,UAAU,GAAGD,aAAa,IAAIA,aAAa,CAAC,CAAC,CAAC,GAChD,CAACA,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,EAAEE,IAAI,GAChCnC,kBAAkB;QACtBO,YAAY,CAAC2B,UAAU,CAAC;QACxB7B,QAAQ,CAAC4B,aAAa,CAAC;MACzB,CAAC,CAAC;IACJ,CAAC,EAAE,EAAE,CAAC;EACN;EACA;;EAEF,oBACE,IAAAnC,WAAA,CAAAsC,IAAA;IAAKC,SAAS,EAAEtC,aAAc;IAAAuC,QAAA,gBAC5B,IAAAxC,WAAA,CAAAyC,GAAA;MACEF,SAAS,EAAC,WAAW;MACrBG,IAAI,EAAC,MAAM;MACXC,EAAE,EAAC,MAAM;MACTN,IAAI,EAAC,MAAM;MACX/B,EAAE,EAAEA,EAAG;MACPC,QAAQ,EAAEI;IAAS,CACpB,CAAC,eACF,IAAAX,WAAA,CAAAsC,IAAA;MAAOM,OAAO,EAAC,MAAM;MAAAJ,QAAA,gBAClB,IAAAxC,WAAA,CAAAyC,GAAA;QAAKI,KAAK,EAAC,4BAA4B;QAACC,KAAK,EAAC,IAAI;QAACC,MAAM,EAAC,IAAI;QAACC,OAAO,EAAC,WAAW;QAAAR,QAAA,eAAC,IAAAxC,WAAA,CAAAyC,GAAA;UAAMQ,CAAC,EAAC;QAA4P,CAAC;MAAC,CAAK,CAAC,eAC/V,IAAAjD,WAAA,CAAAyC,GAAA;QAAAD,QAAA,EAAOhC;MAAS,CAAO,CAAC;IAAA,CACpB,CAAC;EAAA,CACJ,CAAC;AAEX,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AATA,IAAA0C,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAWehD,eAAe","ignoreList":[]}