{"version":3,"sources":["../../../src/components/browser-watch/AddToWatchDialog.jsx"],"names":["styles","DialogStyles","actionCompleted","WAT","EDIT_WATCH_COMPLETED","actionFailed","EDIT_WATCH_FAILED","forActionType","ADD_ITEM","S","BOLD","fontWeight","LH","lineHeight","DESCR","color","AddToWatchDialog","WithValidation","displayName","getInitialState","store","props","groupCaption","listCaption","_commandButtons","_handlerAdd","groupOptions","getWatchGroups","listOptions","validationMessages","componentDidMount","unsubscribe","listen","_onStore","componetWillUnmount","actionType","data","state","length","setState","onClose","messages","UNSAFE_componentWillReceiveProps","nextProps","isShow","groups","lists","getWatchListsByGroup","shouldComponentUpdate","nextState","_handlerSelectGroup","group","caption","_handlerSelectList","list","_getValidationMessages","isValid","config","WatchActions","addItem","_updateValidationMessages","msg","push","Msg","NOT_SELECTED","_handlerClose","render","descr","rowDiv","labelSpan"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport createReactClass from 'create-react-class'\r\n\r\n//import PropTypes from 'prop-types'\r\n\r\nimport WithValidation from '../dialogs/WithValidation'\r\n\r\nimport WatchActions from '../../flux/actions/WatchActions'\r\nimport { WatchActionTypes as WAT } from '../../flux/actions/WatchActions'\r\nimport Msg from '../../constants/Msg'\r\n\r\nimport ModalDialog from '../zhn-moleculs/ModalDialog';\r\nimport FlatButton from '../zhn-m/FlatButton'\r\nimport InputSelect from '../zhn-select/InputSelect'\r\nimport ValidationMessagesFragment from '../zhn-moleculs/ValidationMessagesFragment';\r\n\r\nimport DialogStyles from '../styles/DialogStyles'\r\n\r\nconst styles = DialogStyles;\r\n\r\nconst actionCompleted = WAT.EDIT_WATCH_COMPLETED\r\n    , actionFailed =  WAT.EDIT_WATCH_FAILED\r\n    , forActionType = WAT.ADD_ITEM\r\n\r\nconst S = {\r\n  BOLD: {\r\n    fontWeight: 'bold'\r\n  },\r\n  LH: {\r\n    lineHeight: 2\r\n  },\r\n  DESCR: {\r\n    fontWeight: 'bold',\r\n    color: 'gray'\r\n  }\r\n};\r\n\r\nconst AddToWatchDialog = createReactClass({\r\n  ...WithValidation,\r\n\r\n  displayName : 'AddToWatchDialog',\r\n  /*\r\n  propTypes : {\r\n    isShow  : PropTypes.bool.isRequired,\r\n    data    : PropTypes.object.isRequired,\r\n    store   : PropTypes.object,\r\n    onClose : PropTypes.func.isRequired\r\n  },\r\n  */\r\n  getInitialState(){\r\n    const { store } = this.props;\r\n    this.groupCaption = null;\r\n    this.listCaption = null;\r\n    this._commandButtons = [\r\n      <FlatButton\r\n        key=\"add\"\r\n        caption=\"Add\"\r\n        title=\"Click to add to watch list\"\r\n        timeout={0}\r\n        onClick={this._handlerAdd}\r\n      />\r\n   ];\r\n    return {\r\n      groupOptions: store.getWatchGroups(),\r\n      listOptions: [],\r\n      validationMessages: []\r\n    }\r\n  },\r\n\r\n  componentDidMount(){\r\n    this.unsubscribe = this.props.store.listen(this._onStore);\r\n  },\r\n  componetWillUnmount(){\r\n    this.unsubscribe()\r\n  },\r\n  _onStore(actionType, data){\r\n    if (actionType === actionCompleted && data.forActionType === forActionType){\r\n       if (this.state.validationMessages.length>0){\r\n         this.setState({ validationMessages:[] });\r\n       }\r\n       this.props.onClose();\r\n    } else if (actionType === actionFailed && data.forActionType === forActionType){\r\n       this.setState({ validationMessages:data.messages });\r\n    }\r\n  },\r\n\r\n  UNSAFE_componentWillReceiveProps(nextProps){\r\n    if (nextProps !== this.props && nextProps.isShow !== this.props.isShow) {\r\n      const groups = nextProps.store.getWatchGroups();\r\n      if (groups !== this.state.groupOptions){\r\n        this.groupCaption = null;\r\n        this.listCaption = null;\r\n        this.setState({groupOptions:groups, listOptions:[]});\r\n      } else if (this.groupCaption){\r\n        const lists = nextProps.store.getWatchListsByGroup(this.groupCaption);\r\n        if (lists !== this.state.listOptions){\r\n          this.listCaption = null;\r\n          this.setState({listOptions:lists})\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  shouldComponentUpdate(nextProps, nextState){\r\n    if (nextProps !== this.props && nextProps.isShow === this.props.isShow) {\r\n      return false;\r\n    }\r\n    return true;\r\n  },\r\n\r\n  _handlerSelectGroup(group){\r\n    if (group && group.caption){\r\n       //const {store} = this.props;\r\n       this.groupCaption = group.caption;\r\n       if (group.lists){\r\n         this.setState({listOptions : group.lists})\r\n       }  else {\r\n         this.setState({listOptions : []})\r\n       }\r\n    } else {\r\n      this.groupCaption = null;\r\n    }\r\n  },\r\n  _handlerSelectList(list){\r\n      if (list && list.caption){\r\n        this.listCaption = list.caption;\r\n      } else {\r\n        this.listCaption = null;\r\n      }\r\n  },\r\n  _handlerAdd(){\r\n    const validationMessages = this._getValidationMessages();\r\n    if (validationMessages.isValid){\r\n      //onClose\r\n      const { data } = this.props\r\n          , { caption, config } = data\r\n          , { groupCaption, listCaption } = this;\r\n\r\n      WatchActions.addItem({ caption, groupCaption, listCaption, config });\r\n    } else {\r\n      this._updateValidationMessages(validationMessages);\r\n    }\r\n  },\r\n  _getValidationMessages(){\r\n    const msg = [];\r\n    if (!this.groupCaption){ msg.push(Msg.NOT_SELECTED('Group'));}\r\n    if (!this.listCaption) { msg.push(Msg.NOT_SELECTED('List'));}\r\n    msg.isValid = (msg.length === 0) ? true : false;\r\n    return msg;\r\n  },\r\n\r\n  _handlerClose(){\r\n    if (this.state.validationMessages.length>0){\r\n      this.setState({validationMessages: []});\r\n    }\r\n    this.props.onClose();\r\n  },\r\n\r\n  render(){\r\n    const { isShow, data } = this.props\r\n        , { caption, config={} } = data\r\n        , { descr } = config\r\n        , { groupOptions, listOptions, validationMessages } = this.state;\r\n\r\n    return (\r\n      <ModalDialog\r\n         caption=\"Add To Watch List\"\r\n         isShow={isShow}\r\n         commandButtons={this._commandButtons}\r\n         onClose={this._handlerClose}\r\n      >\r\n        <div style={styles.rowDiv} key=\"1\">\r\n          <span style={styles.labelSpan}>\r\n            Group:\r\n          </span>\r\n          <InputSelect\r\n             width=\"250\"\r\n             options={groupOptions}\r\n             onSelect={this._handlerSelectGroup}\r\n           />\r\n        </div>\r\n        <div style={styles.rowDiv} key=\"2\">\r\n          <span style={styles.labelSpan}>\r\n            List:\r\n          </span>\r\n          <InputSelect\r\n             width=\"250\"\r\n             options={listOptions}\r\n             onSelect={this._handlerSelectList}\r\n           />\r\n        </div>\r\n        <div style={{...styles.rowDiv, ...S.LH}} key=\"3\">\r\n          <span style={styles.labelSpan}>\r\n            Item:\r\n          </span>\r\n          <span style={S.BOLD}>\r\n             {caption}\r\n          </span>\r\n        </div>\r\n        <div style={{...styles.rowDiv, ...S.LH}} key=\"4\">\r\n          <span style={styles.labelSpan}>\r\n             Descr:\r\n          </span>\r\n          <span style={S.DESCR}>\r\n             {descr}\r\n          </span>\r\n        </div>\r\n        <ValidationMessagesFragment\r\n           key=\"5\"\r\n           validationMessages={validationMessages}\r\n         />\r\n      </ModalDialog>\r\n    );\r\n  }\r\n});\r\n\r\nexport default AddToWatchDialog\r\n"],"file":"AddToWatchDialog.js"}