{"version":3,"sources":["../../../src/components/zhn-modal-slider/ModalSlider.jsx"],"names":["PERIOD_MS","S","SHOW_HIDE","position","overflow","PAGES","display","flexFlow","alignItems","overflowX","transition","_getTranslateX","node","_prevStr","style","transform","substr","replace","parseInt","ModalSlider","props","INIT_ID","pageWidth","maxPages","model","onClose","_pW","_maxP","pages","hNextPage","bind","hPrevPage","_PAGE_WIDTH","_pagesStyle","width","_pageStyle","push","baseTitleCl","itemCl","_direction","state","pageCurrent","isShow","className","rootStyle","_transform","_crTransform","_showHideStyle","_divStyle","_refPages","_renderPages","Component","defaultProps","p0","pageNumber","setState","prevState","_addPage","id","title","_max","length","key","splice","_WIDTH","dX","_pagesNode","_prevInt","n","map","Page","index","React","cloneElement"],"mappings":"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","file":"ModalSlider.js","sourcesContent":["import React, { Component } from 'react'\r\n\r\nimport throttleOnce from '../../utils/throttleOnce'\r\n\r\nimport ModalPane from '../zhn-moleculs/ModalPane';\r\nimport ShowHide from '../zhn-atoms/ShowHide';\r\n\r\nimport MenuPage from './MenuPage'\r\n\r\nconst PERIOD_MS = 750;\r\n\r\nconst S = {\r\n  SHOW_HIDE: {\r\n    position: 'absolute',\r\n    overflow: 'hidden'\r\n  },\r\n  PAGES: {\r\n    display: 'flex',\r\n    flexFlow: 'row nowrap',\r\n    alignItems: 'flex-start',\r\n    overflowX: 'hidden',\r\n    transition: `all ${PERIOD_MS}ms ease-out`\r\n  }\r\n};\r\n\r\nconst _getTranslateX = (node) => {\r\n  const _prevStr = node\r\n    .style.transform\r\n    .substr(11)\r\n    .replace('px', '')\r\n    .replace(')', '');\r\n  return parseInt(_prevStr, 10);\r\n}\r\n\r\nclass ModalSlider extends Component {\r\n  /*\r\n  static propTypes = {\r\n    rootStyle: PropTypes.object,\r\n    className: PropTypes.string,\r\n    style: PropTypes.object,\r\n\r\n    pageWidth: PropTypes.number,\r\n    maxPages: PropTypes.number,\r\n    model: PropTypes.object,\r\n\r\n    onClose: PropTypes.func\r\n  }\r\n  */\r\n\r\n  static defaultProps = {\r\n    INIT_ID: 'p0',\r\n    model: {\r\n      pageWidth: 100,\r\n      maxPages: 2,\r\n      p0: []\r\n    }\r\n  }\r\n\r\n  constructor(props){\r\n    super(props)\r\n    const {\r\n      INIT_ID,\r\n      pageWidth, maxPages,\r\n      model,\r\n      onClose\r\n    } = props\r\n    , _pW = model.pageWidth || pageWidth\r\n    , _maxP = model.maxPages || maxPages\r\n    , pages = [];\r\n\r\n    this.hNextPage = throttleOnce(\r\n      this.hNextPage.bind(this)\r\n    )\r\n    this.hPrevPage = throttleOnce(\r\n      this.hPrevPage.bind(this)\r\n    )\r\n\r\n    this._PAGE_WIDTH = _pW\r\n    this._pagesStyle = {\r\n      width: `${_maxP*_pW}px`\r\n    }\r\n    this._pageStyle = {\r\n      width: `${_pW}px`,\r\n    }\r\n\r\n    pages.push((\r\n      <MenuPage\r\n        key={INIT_ID}\r\n        style={this._pageStyle}\r\n        items={model[INIT_ID]}\r\n        baseTitleCl={model.baseTitleCl}\r\n        itemCl={model.itemCl}\r\n        onNextPage={this.hNextPage}\r\n        onClose={onClose}\r\n      />\r\n    ))\r\n\r\n    this._direction = 0\r\n\r\n    this.state = {\r\n      pageCurrent: 1,\r\n      pages\r\n    }\r\n  }\r\n\r\n\r\n  hPrevPage = (pageNumber) => {\r\n    this.setState(prevState => {\r\n      prevState.pageCurrent = pageNumber - 1\r\n      this._direction = -1\r\n      return prevState;\r\n    })\r\n  }\r\n\r\n  _addPage = (pages, id, title) => {\r\n    const {\r\n            model,\r\n            onClose\r\n          } = this.props;\r\n    pages.push((\r\n      <MenuPage\r\n        key={id}\r\n        style={this._pageStyle}\r\n        title={title}\r\n        items={model[id]}\r\n        baseTitleCl={model.baseTitleCl}\r\n        itemCl={model.itemCl}\r\n        onPrevPage={this.hPrevPage}\r\n        onClose={onClose}\r\n      />\r\n    ))\r\n  }\r\n\r\n  hNextPage = (id, title, pageNumber) => {\r\n    this.setState(prevState => {\r\n       const { pages } = prevState\r\n          , _max = pages.length-1;\r\n\r\n      if ( (_max+1) > pageNumber) {\r\n        if (pages[pageNumber] && pages[pageNumber].key !== id) {\r\n           if (pageNumber>0) {\r\n             prevState.pages.splice(pageNumber)\r\n           } else {\r\n             prevState.pages = []\r\n           }\r\n           this._addPage(prevState.pages, id, title)\r\n        }\r\n      } else {\r\n        this._addPage(pages, id, title)\r\n      }\r\n\r\n      prevState.pageCurrent = pageNumber + 1\r\n      //prevState.direction = 1\r\n      this._direction = 1\r\n      return prevState;\r\n    })\r\n  }\r\n\r\n  _crTransform = () => {\r\n    const _WIDTH = this._PAGE_WIDTH;\r\n    let dX = '0';\r\n    if (this._direction !== 0 && this._pagesNode) {\r\n      const _prevInt = _getTranslateX(this._pagesNode);\r\n      dX = this._direction === 1\r\n         ? _prevInt-_WIDTH\r\n         : _prevInt+_WIDTH\r\n      this._direction = 0\r\n    } else if ( this._direction === 0 && this._pagesNode) {\r\n      dX = _getTranslateX(this._pagesNode)\r\n    }\r\n\r\n    return { transform: `translateX(${dX}px)` };\r\n  }\r\n\r\n  _refPages = n => this._pagesNode = n\r\n\r\n  _renderPages = () => {\r\n    const { pages, pageCurrent } = this.state;\r\n    return pages.map((Page, index) => {\r\n      return React.cloneElement(Page, {\r\n        pageCurrent,\r\n        //pageNumber: index,\r\n        pageNumber: index + 1,\r\n      });\r\n    })\r\n  }\r\n\r\n  render(){\r\n    const { _pagesStyle, _pageStyle } = this\r\n        , { isShow, className, rootStyle, style, onClose } = this.props\r\n        , _transform = this._crTransform()\r\n        , _showHideStyle = {\r\n            ...style,\r\n            ...S.SHOW_HIDE,\r\n            ..._pageStyle\r\n          }\r\n        , _divStyle = {\r\n             ...S.PAGES,\r\n             ..._pagesStyle,\r\n             ..._transform\r\n           };    \r\n    return (\r\n      <ModalPane\r\n        isShow={isShow}\r\n        style={rootStyle}\r\n        onClose={onClose}\r\n      >\r\n        <ShowHide\r\n          className={className}\r\n          style={_showHideStyle}\r\n          isShow={isShow}\r\n        >\r\n          <div\r\n            ref={this._refPages}\r\n            style={_divStyle}\r\n          >\r\n            {this._renderPages()}\r\n          </div>\r\n        </ShowHide>\r\n      </ModalPane>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ModalSlider\r\n"]}